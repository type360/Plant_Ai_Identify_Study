(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c9d5bcd"],{9319:function(e,t,a){"use strict";a("aa18")},9406:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container"},[a("el-card",{staticClass:"welcome-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"welcome-content"},[a("div",{staticClass:"user-avatar"},[a("el-avatar",{attrs:{size:80,src:e.avatar?e.avatar:"",icon:e.avatar?"":"el-icon-user-solid"}})],1),a("div",{staticClass:"user-info"},[a("h2",{staticClass:"welcome-title"},[e._v("欢迎回来，"+e._s(e.name))]),a("p",{staticClass:"welcome-subtitle"},[e._v(" 今天是 "+e._s(e.currentDate)+"，祝您使用愉快！ ")])]),a("div",{staticClass:"user-actions"},[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-user"},on:{click:e.showUserInfo}},[e._v(" 个人信息 ")])],1)])]),a("el-dialog",{attrs:{title:"个人信息",visible:e.userInfoDialogVisible,width:"500px","close-on-click-modal":!1,"custom-class":"user-info-dialog"},on:{"update:visible":function(t){e.userInfoDialogVisible=t},closed:e.resetUserInfoForm}},[e.isEditing?a("el-form",{ref:"userInfoForm",staticClass:"user-info-form",attrs:{model:e.userInfoForm,rules:e.userInfoRules,"label-width":"80px","status-icon":""}},[a("div",{staticClass:"form-header"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"#","show-file-list":!1,"before-upload":e.beforeAvatarUpload,"http-request":e.uploadAvatar}},[e.userInfoForm.headerUrl?a("img",{staticClass:"avatar",attrs:{src:e.userInfoForm.headerUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("span",{staticClass:"upload-tip"},[e._v("点击上传头像")])],1),a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{placeholder:"请输入用户名",maxlength:"20","show-word-limit":"","prefix-icon":"el-icon-user"},model:{value:e.userInfoForm.username,callback:function(t){e.$set(e.userInfoForm,"username",t)},expression:"userInfoForm.username"}})],1),a("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[a("el-input",{attrs:{placeholder:"请输入姓名",maxlength:"20","show-word-limit":"","prefix-icon":"el-icon-s-custom"},model:{value:e.userInfoForm.realName,callback:function(t){e.$set(e.userInfoForm,"realName",t)},expression:"userInfoForm.realName"}})],1),a("el-form-item",{attrs:{label:"电话",prop:"telephone"}},[a("el-input",{attrs:{placeholder:"请输入电话",maxlength:"11","show-word-limit":"","prefix-icon":"el-icon-phone"},model:{value:e.userInfoForm.telephone,callback:function(t){e.$set(e.userInfoForm,"telephone",t)},expression:"userInfoForm.telephone"}})],1)],1):a("div",{staticClass:"user-info-display"},[a("div",{staticClass:"info-header"},[a("el-avatar",{attrs:{size:80,src:e.userInfo.headerUrl,icon:e.userInfo.headerUrl?"":"el-icon-user-solid"}}),a("h3",{staticClass:"user-name"},[e._v(e._s(e.userInfo.username))])],1),a("div",{staticClass:"info-content"},[a("div",{staticClass:"info-item"},[a("i",{staticClass:"el-icon-user"}),a("span",{staticClass:"label"},[e._v("姓名：")]),a("span",{staticClass:"value"},[e._v(e._s(e.userInfo.realName))])]),a("div",{staticClass:"info-item"},[a("i",{staticClass:"el-icon-phone"}),a("span",{staticClass:"label"},[e._v("电话：")]),a("span",{staticClass:"value"},[e._v(e._s(e.userInfo.telephone))])])])]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.userInfoDialogVisible=!1}}},[e._v("关闭")]),e.isEditing?a("el-button",{attrs:{type:"primary",loading:e.saveLoading,icon:"el-icon-check"},on:{click:e.saveUserInfo}},[e._v("保存")]):a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.startEditing}},[e._v("修改")])],1)],1),a("div",{staticClass:"stats-container"},[a("el-card",{staticClass:"stats-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[a("i",{staticClass:"el-icon-data-analysis"}),a("span",[e._v("模型统计数据")])]),a("div",{staticClass:"model-counts"},[a("el-row",{attrs:{gutter:20}},e._l(e.dashboardData.modelCounts,(function(t){return a("el-col",{key:t.labelName,attrs:{span:8}},[a("div",{staticClass:"count-item",class:e.getCountItemClass(t.index)},[a("div",{staticClass:"count-icon"},[a("i",{class:e.getCountIcon(t.index)})]),a("div",{staticClass:"count-info"},[a("div",{staticClass:"count-value"},[e._v(e._s(t.modelCount))]),a("div",{staticClass:"count-label"},[e._v(e._s(e.getShowLabel(t.index)))])])])])})),1)],1)]),a("el-card",{staticClass:"chart-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[a("i",{staticClass:"el-icon-data-line"}),a("span",[e._v("本周模型训练情况")])]),a("div",{ref:"chartContainer",staticClass:"chart-container"})])],1)],1)},r=[],n=a("c7eb"),i=a("1da1"),o=a("5530"),l=(a("99af"),a("caad"),a("d81d"),a("b64b"),a("d3b7"),a("0643"),a("a573"),a("9a9a"),a("2f62")),c=a("b775");function u(){return Object(c["a"])({url:"/index/getChartData",method:"get"})}var d=a("c24f"),h=a("313e"),f={name:"Dashboard",data:function(){return{dashboardData:{modelCounts:[],modelCharts:[]},chart:null,timer:null,currentDate:"",userInfoDialogVisible:!1,isEditing:!1,userInfo:{userId:null,username:"",realName:"",telephone:"",headerUrl:""},userInfoForm:{userId:null,username:"",realName:"",telephone:"",headerUrl:""},userInfoRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],realName:[],telephone:[]},saveLoading:!1,originalUserInfo:{}}},computed:Object(o["a"])({},Object(l["b"])(["userId","name","avatar"])),created:function(){this.updateDate(),this.fetchDashboardData()},mounted:function(){var e=this;this.$nextTick((function(){e.initChart()})),this.timer=setInterval((function(){e.fetchDashboardData()}),1e3),window.addEventListener("resize",this.resizeChart)},beforeDestroy:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.chart&&(this.chart.dispose(),this.chart=null),window.removeEventListener("resize",this.resizeChart)},methods:{updateDate:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1,s=e.getDate(),r=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][e.getDay()];this.currentDate="".concat(t,"年").concat(a,"月").concat(s,"日 ").concat(r)},fetchDashboardData:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){var a;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u();case 3:a=t.sent,200===a.code&&a.data&&(e.dashboardData=a.data,e.updateChartData()),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("获取首页数据失败:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},initChart:function(){if(this.$refs.chartContainer){this.chart=h["a"](this.$refs.chartContainer);var e={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["初始训练","优化训练"],top:10,textStyle:{fontSize:12}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:["周一","周二","周三","周四","周五","周六","周日"]},yAxis:{type:"value",minInterval:1},series:[{name:"初始训练",type:"bar",stack:"total",barWidth:"40%",itemStyle:{color:"#409EFF"},emphasis:{focus:"series"},data:[0,0,0,0,0,0,0]},{name:"优化训练",type:"bar",stack:"total",barWidth:"40%",itemStyle:{color:"#67C23A"},emphasis:{focus:"series"},data:[0,0,0,0,0,0,0]}]};this.chart.setOption(e)}},updateChartData:function(){if(this.chart&&this.dashboardData.modelCharts){var e=this.dashboardData.modelCharts.map((function(e){return e.initCount})),t=this.dashboardData.modelCharts.map((function(e){return e.optimizeCount}));this.chart.setOption({series:[{name:"初始训练",data:e},{name:"优化训练",data:t}]})}},resizeChart:function(){this.chart&&this.chart.resize()},getShowLabel:function(e){var t={5:"模型总数",0:"未训练",1:"训练中",2:"优化中",3:"评估中",4:"完成"};return t[e]||""},getCountItemClass:function(e){var t={5:"total",0:"untrained",1:"training",2:"optimizing",3:"evaluating",4:"completed"};return t[e]||""},getCountIcon:function(e){var t={5:"el-icon-s-grid",0:"el-icon-s-release",1:"el-icon-loading",2:"el-icon-refresh",3:"el-icon-data-analysis",4:"el-icon-check"};return t[e]||"el-icon-data-line"},showUserInfo:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){var a;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.userInfoDialogVisible=!0,t.next=3,Object(d["d"])(e.userId);case 3:a=t.sent,200===a.code&&(e.userInfo=Object(o["a"])({},a.data),e.userInfoForm=Object(o["a"])({},a.data),e.originalUserInfo=Object(o["a"])({},a.data));case 5:case"end":return t.stop()}}),t)})))()},startEditing:function(){this.isEditing=!0},beforeAvatarUpload:function(e){var t=["image/png","image/jpg","image/jpeg","image/gif"].includes(e.type),a=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 PNG、JPG、JPEG、GIF 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a},uploadAvatar:function(e){var t=this;return Object(i["a"])(Object(n["a"])().mark((function a(){var s,r;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:s=e.file,r=new FormData,r.append("file",s),t.$store.dispatch("user/uploadAvatar",r).then((function(e){t.userInfoForm.headerUrl=e}));case 4:case"end":return a.stop()}}),a)})))()},saveUserInfo:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.userInfoForm.validate(function(){var t=Object(i["a"])(Object(n["a"])().mark((function t(a){var s,r;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=15;break}if(s=Object.keys(e.userInfoForm).some((function(t){return e.userInfoForm[t]!==e.originalUserInfo[t]})),s){t.next=6;break}return e.$message.info("数据未发生变化"),e.userInfoDialogVisible=!1,t.abrupt("return");case 6:return e.saveLoading=!0,t.prev=7,t.next=10,Object(d["g"])(e.userInfoForm);case 10:r=t.sent,200===r.code&&(e.$message.success("保存成功"),e.userInfo=Object(o["a"])({},e.userInfoForm),e.originalUserInfo=Object(o["a"])({},e.userInfoForm),e.isEditing=!1);case 12:return t.prev=12,e.saveLoading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[7,,12,15]])})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},resetUserInfoForm:function(){this.isEditing=!1,this.userInfo={userId:null,username:"",realName:"",telephone:"",headerUrl:""},this.userInfoForm={userId:null,username:"",realName:"",telephone:"",headerUrl:""},this.originalUserInfo={},this.$refs.userInfoForm&&this.$refs.userInfoForm.resetFields()}}},m=f,p=(a("9319"),a("2877")),v=Object(p["a"])(m,s,r,!1,null,"219e8d2a",null);t["default"]=v.exports},aa18:function(e,t,a){}}]);