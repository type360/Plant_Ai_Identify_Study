(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03b64ee0"],{"06c5":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));r("a630"),r("fb6a"),r("b0c0"),r("d3b7"),r("ac1f"),r("00b4"),r("25f0"),r("3ca3");var a=r("6b75");function s(e,t){if(e){if("string"==typeof e)return Object(a["a"])(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(a["a"])(e,t):void 0}}},"25f0":function(e,t,r){"use strict";var a=r("6eeb"),s=r("825a"),n=r("d039"),i=r("ad6d"),o="toString",l=RegExp.prototype,c=l[o],u=n((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d=c.name!=o;(u||d)&&a(RegExp.prototype,o,(function(){var e=s(this),t=String(e.source),r=e.flags,a=String(void 0===r&&e instanceof RegExp&&!("flags"in l)?i.call(e):r);return"/"+t+"/"+a}),{unsafe:!0})},2909:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r("6b75");function s(e){if(Array.isArray(e))return Object(a["a"])(e)}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("d3b7"),r("3ca3"),r("ddb0");function n(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var i=r("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return s(e)||n(e)||Object(i["a"])(e)||o()}},"312e":function(e,t,r){},3786:function(e,t,r){"use strict";r.d(t,"d",(function(){return s})),r.d(t,"f",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"e",(function(){return l})),r.d(t,"a",(function(){return c}));var a=r("b775");function s(){return Object(a["a"])({url:"/auth/roles",method:"get"})}function n(e){return Object(a["a"])({url:"/auth/role/".concat(e),method:"get"})}function i(e){return Object(a["a"])({url:"/auth/assign/role",method:"post",data:e})}function o(){return Object(a["a"])({url:"/auth/permissions",method:"get"})}function l(e){return Object(a["a"])({url:"/auth/permission/".concat(e),method:"get"})}function c(e){return Object(a["a"])({url:"/auth/assign/permission",method:"post",data:e})}},4041:function(e,t,r){"use strict";r("312e")},"4df4":function(e,t,r){"use strict";var a=r("0366"),s=r("7b0b"),n=r("9bdd"),i=r("e95a"),o=r("50c4"),l=r("8418"),c=r("35a1");e.exports=function(e){var t,r,u,d,f,m,g=s(e),p="function"==typeof this?this:Array,b=arguments.length,h=b>1?arguments[1]:void 0,v=void 0!==h,y=c(g),C=0;if(v&&(h=a(h,b>2?arguments[2]:void 0,2)),void 0==y||p==Array&&i(y))for(t=o(g.length),r=new p(t);t>C;C++)m=v?h(g[C],C):g[C],l(r,C,m);else for(d=y.call(g),f=d.next,r=new p;!(u=f.call(d)).done;C++)m=v?n(d,h,[u.value,C],!0):u.value,l(r,C,m);return r.length=C,r}},"572f":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-container"},[r("el-card",{staticClass:"filter-card",attrs:{shadow:"hover"}},[r("div",{staticClass:"filter-container"},[r("div",{staticClass:"search-box"},[r("el-input",{attrs:{placeholder:"请输入账号、姓名或者电话号码",clearable:""},on:{input:e.debounceSearch,clear:e.handleSearch},model:{value:e.queryParams.keyword,callback:function(t){e.$set(e.queryParams,"keyword",t)},expression:"queryParams.keyword"}},[r("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})])],1),r("div",{staticClass:"operation-box"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增用户")])],1)])]),r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"user-list"},[r("el-row",{attrs:{gutter:20}},e._l(e.userList,(function(t){return r("el-col",{key:t.userId,attrs:{xs:24,sm:12,md:8,lg:6}},[r("div",{staticClass:"user-card"},[r("div",{staticClass:"card-header"},[r("div",{staticClass:"status-indicator",class:0===t.status?"active":"inactive"}),r("div",{staticClass:"avatar-wrapper"},[r("el-avatar",{attrs:{size:56,src:t.headerUrl}})],1),r("div",{staticClass:"user-info"},[r("h3",{staticClass:"username"},[e._v(e._s(t.username))]),r("p",{staticClass:"realname"},[e._v(e._s(t.realName))])])]),r("div",{staticClass:"card-body"},[r("div",{staticClass:"info-row"},[r("div",{staticClass:"info-label"},[r("i",{staticClass:"el-icon-mobile-phone"})]),r("div",{staticClass:"info-value"},[e._v(e._s(t.telephone))])]),r("div",{staticClass:"info-row"},[r("div",{staticClass:"info-label"},[r("i",{staticClass:"el-icon-time"})]),r("div",{staticClass:"info-value"},[e._v(e._s(t.createTime))])]),r("div",{staticClass:"status-control"},[r("span",{staticClass:"status-text"},[e._v(e._s(0===t.status?"已启用":"已禁用"))]),r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(r){return e.handleStatusChange(r,t)}},model:{value:0===t.status,callback:function(r){e.$set(t,"status === 0",r)},expression:"user.status === 0"}})],1)]),r("div",{staticClass:"card-footer"},[r("el-tooltip",{attrs:{content:"重置密码",placement:"top",effect:"light"}},[r("el-button",{staticClass:"action-btn reset-btn",on:{click:function(r){return e.handleResetPassword(t)}}},[r("i",{staticClass:"el-icon-key"})])],1),r("el-tooltip",{attrs:{content:"删除用户",placement:"top",effect:"light"}},[r("el-popconfirm",{attrs:{title:"确定删除该用户吗？",icon:"el-icon-warning","icon-color":"red"},on:{confirm:function(r){return e.handleDelete(t)}}},[r("el-button",{staticClass:"action-btn delete-btn",attrs:{slot:"reference"},slot:"reference"},[r("i",{staticClass:"el-icon-delete"})])],1)],1),r("el-tooltip",{attrs:{content:"分配角色",placement:"top",effect:"light"}},[r("el-button",{staticClass:"action-btn role-btn",on:{click:function(r){return e.handleAssignRole(t)}}},[r("i",{staticClass:"el-icon-user"})])],1)],1)])])})),1),0!==e.userList.length||e.loading?e._e():r("el-empty",{attrs:{description:"暂无用户数据"}}),e.total>0?r("div",{staticClass:"pagination-container"},[r("el-pagination",{attrs:{background:"","current-page":e.queryParams.pageNum,"page-sizes":[8,16,24,32],"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1),r("el-dialog",{attrs:{title:"新增用户",visible:e.dialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.rules,"label-width":"80px","status-icon":""}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{placeholder:"请输入用户名",autocomplete:"off"},model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),r("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[r("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.userForm.realName,callback:function(t){e.$set(e.userForm,"realName",t)},expression:"userForm.realName"}})],1),r("el-form-item",{attrs:{label:"手机号码",prop:"telephone"}},[r("el-input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.userForm.telephone,callback:function(t){e.$set(e.userForm,"telephone",t)},expression:"userForm.telephone"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancelAdd}},[e._v("取消")]),r("el-button",{attrs:{type:"primary",loading:e.saveLoading},on:{click:e.saveUser}},[e._v("保存")])],1)],1),r("el-dialog",{attrs:{title:"分配角色",visible:e.roleDialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.roleDialogVisible=t},closed:e.resetRoleForm}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.roleLoading,expression:"roleLoading"}],staticClass:"role-dialog-content"},[r("div",{staticClass:"role-info"},[r("div",{staticClass:"user-info-item"},[r("span",{staticClass:"label"},[e._v("用户名：")]),r("span",{staticClass:"value"},[e._v(e._s(e.currentUser.username))])]),r("div",{staticClass:"user-info-item"},[r("span",{staticClass:"label"},[e._v("姓名：")]),r("span",{staticClass:"value"},[e._v(e._s(e.currentUser.realName||"未设置"))])])]),r("div",{staticClass:"role-selection"},[r("div",{staticClass:"selection-title"},[e._v("请选择角色")]),r("div",{staticClass:"role-cards"},e._l(e.roleList,(function(t){return r("div",{key:t.roleId,staticClass:"role-card",class:{"is-selected":e.selectedRoleIds.includes(Number(t.roleId))},on:{click:function(r){e.toggleRole(Number(t.roleId))}}},[r("div",{staticClass:"role-icon"},[r("i",{staticClass:"el-icon-user"})]),r("div",{staticClass:"role-name"},[e._v(e._s(t.roleName))])])})),0)])]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.roleDialogVisible=!1}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary",loading:e.assignLoading},on:{click:e.submitRoleAssign}},[e._v("分配")])],1)])],1)},s=[],n=r("2909");function i(e){if(Array.isArray(e))return e}r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0");function o(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,s,n,i,o=[],l=!0,c=!1;try{if(n=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=n.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,s=e}finally{try{if(!l&&null!=r["return"]&&(i=r["return"](),Object(i)!==i))return}finally{if(c)throw s}}return o}}var l=r("06c5");function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){return i(e)||o(e,t)||Object(l["a"])(e,t)||c()}var d=r("5530"),f=r("c7eb"),m=r("1da1"),g=(r("99af"),r("caad"),r("a434"),r("2532"),r("0643"),r("76d6"),r("c24f")),p=r("3786"),b={name:"UserManagement",data:function(){return{queryParams:{pageNum:1,pageSize:8,keyword:""},userList:[],total:0,loading:!1,dialogVisible:!1,searchTimer:null,userForm:{username:"",realName:"",telephone:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],realName:[{max:20,message:"长度不能超过 20 个字符",trigger:"blur"}],telephone:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}]},saveLoading:!1,roleDialogVisible:!1,roleLoading:!1,currentUser:{},roleList:[],selectedRoleIds:[],assignLoading:!1,originalRoleIds:[]}},created:function(){this.getList()},methods:{getList:function(){var e=this;return Object(m["a"])(Object(f["a"])().mark((function t(){var r;return Object(f["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,Object(g["e"])(e.queryParams);case 4:r=t.sent,200===r.code?(e.userList=r.data.data,e.total=r.data.total):e.$message.error(r.message||"获取用户列表失败");case 6:return t.prev=6,e.loading=!1,t.finish(6);case 9:case"end":return t.stop()}}),t,null,[[1,,6,9]])})))()},debounceSearch:function(){var e=this;this.searchTimer&&clearTimeout(this.searchTimer),this.searchTimer=setTimeout((function(){e.handleSearch()}),300)},handleSearch:function(){this.queryParams.pageNum=1,this.getList()},handleSizeChange:function(e){this.queryParams.pageSize=e,this.getList()},handleCurrentChange:function(e){this.queryParams.pageNum=e,this.getList()},handleAdd:function(){var e=this;this.dialogVisible=!0,this.$nextTick((function(){e.$refs.userForm&&e.$refs.userForm.resetFields()}))},cancelAdd:function(){this.dialogVisible=!1,this.$refs.userForm.resetFields()},saveUser:function(){var e=this;this.$refs.userForm.validate(function(){var t=Object(m["a"])(Object(f["a"])().mark((function t(r){var a;return Object(f["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=12;break}return t.prev=1,e.saveLoading=!0,t.next=5,Object(g["a"])(e.userForm);case 5:a=t.sent,200===a.code?(e.$message.success("用户添加成功"),e.dialogVisible=!1,e.getList()):e.$message.error(a.message||"用户添加失败");case 7:return t.prev=7,e.saveLoading=!1,t.finish(7);case 10:t.next=13;break;case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t,null,[[1,,7,10]])})));return function(e){return t.apply(this,arguments)}}())},handleStatusChange:function(e,t){var r=this;return Object(m["a"])(Object(f["a"])().mark((function a(){var s,n;return Object(f["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=e?0:1,a.next=3,Object(g["c"])(t.userId,s);case 3:n=a.sent,200===n.code?(r.$message.success("用户 ".concat(t.username," 已").concat(e?"启用":"禁用")),t.status=s):(r.$message.error(n.message||"状态更新失败"),r.$nextTick((function(){t.status=0===t.status?1:0})));case 5:case"end":return a.stop()}}),a)})))()},handleResetPassword:function(e){var t=this;return Object(m["a"])(Object(f["a"])().mark((function r(){return Object(f["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$confirm("确定要重置用户 ".concat(e.username," 的密码吗？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(m["a"])(Object(f["a"])().mark((function r(){var a;return Object(f["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(g["f"])(e.userId);case 2:a=r.sent,200===a.code?t.$message.success("密码重置成功"):t.$message.error(a.message||"密码重置失败");case 4:case"end":return r.stop()}}),r)})))).catch((function(){}));case 1:case"end":return r.stop()}}),r)})))()},handleDelete:function(e){var t=this;return Object(m["a"])(Object(f["a"])().mark((function r(){var a;return Object(f["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(g["b"])(e.userId);case 2:a=r.sent,200===a.code?(t.$message.success("用户删除成功"),t.getList()):t.$message.error(a.message||"用户删除失败");case 4:case"end":return r.stop()}}),r)})))()},handleAssignRole:function(e){var t=this;return Object(m["a"])(Object(f["a"])().mark((function r(){var a,s,i,o;return Object(f["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.currentUser=Object(d["a"])({},e),t.roleDialogVisible=!0,t.roleLoading=!0,r.prev=3,r.next=6,Promise.all([Object(p["d"])(),Object(p["f"])(e.userId)]);case 6:if(a=r.sent,s=u(a,2),i=s[0],o=s[1],200!==i.code){r.next=14;break}t.roleList=i.data,r.next=17;break;case 14:return t.$message.error(i.message||"获取角色列表失败"),t.roleDialogVisible=!1,r.abrupt("return");case 17:200===o.code?(t.selectedRoleIds=o.data,t.originalRoleIds=Object(n["a"])(t.selectedRoleIds)):(t.$message.error(o.message||"获取用户角色失败"),t.roleDialogVisible=!1);case 18:return r.prev=18,t.roleLoading=!1,r.finish(18);case 21:case"end":return r.stop()}}),r,null,[[3,,18,21]])})))()},resetRoleForm:function(){this.currentUser={},this.roleList=[],this.selectedRoleIds=[],this.originalRoleIds=[]},submitRoleAssign:function(){var e=this;return Object(m["a"])(Object(f["a"])().mark((function t(){var r,a;return Object(f["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.selectedRoleIds.length!==e.originalRoleIds.length||!e.selectedRoleIds.every((function(t){return e.originalRoleIds.includes(t)})),r){t.next=5;break}return e.$message.info("角色未发生变化"),e.roleDialogVisible=!1,t.abrupt("return");case 5:return e.assignLoading=!0,t.prev=6,t.next=9,Object(p["b"])({userId:e.currentUser.userId,roleIds:e.selectedRoleIds});case 9:a=t.sent,200===a.code?(e.$message.success("角色分配成功"),e.roleDialogVisible=!1):e.$message.error(a.message||"角色分配失败");case 11:return t.prev=11,e.assignLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[6,,11,14]])})))()},toggleRole:function(e){var t=this.selectedRoleIds.indexOf(e);-1===t?this.selectedRoleIds.push(e):this.selectedRoleIds.splice(t,1)}}},h=b,v=(r("4041"),r("2877")),y=Object(v["a"])(h,a,s,!1,null,"756022fb",null);t["default"]=y.exports},"6b75":function(e,t,r){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}r.d(t,"a",(function(){return a}))},"76d6":function(e,t,r){"use strict";var a=r("23e7"),s=r("2266"),n=r("1c0b"),i=r("825a");a({target:"Iterator",proto:!0,real:!0},{every:function(e){return i(this),n(e),!s(this,(function(t){if(!e(t))return s.stop()}),void 0,!1,!0).stopped}})},a434:function(e,t,r){"use strict";var a=r("23e7"),s=r("23cb"),n=r("a691"),i=r("50c4"),o=r("7b0b"),l=r("65f0"),c=r("8418"),u=r("1dde"),d=r("ae40"),f=u("splice"),m=d("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,p=Math.min,b=9007199254740991,h="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!f||!m},{splice:function(e,t){var r,a,u,d,f,m,v=o(this),y=i(v.length),C=s(e,y),w=arguments.length;if(0===w?r=a=0:1===w?(r=0,a=y-C):(r=w-2,a=p(g(n(t),0),y-C)),y+r-a>b)throw TypeError(h);for(u=l(v,a),d=0;d<a;d++)f=C+d,f in v&&c(u,d,v[f]);if(u.length=a,r<a){for(d=C;d<y-a;d++)f=d+a,m=d+r,f in v?v[m]=v[f]:delete v[m];for(d=y;d>y-a+r;d--)delete v[d-1]}else if(r>a)for(d=y-a;d>C;d--)f=d+a-1,m=d+r-1,f in v?v[m]=v[f]:delete v[m];for(d=0;d<r;d++)v[d+C]=arguments[d+2];return v.length=y-a+r,u}})},a630:function(e,t,r){var a=r("23e7"),s=r("4df4"),n=r("1c7e"),i=!n((function(e){Array.from(e)}));a({target:"Array",stat:!0,forced:i},{from:s})}}]);