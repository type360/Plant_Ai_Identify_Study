(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-39e4b370"],{2628:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"log-container"},[a("el-card",{staticClass:"header-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"card-header"},[a("div",{staticClass:"header-title"},[a("i",{staticClass:"el-icon-document"}),a("span",[e._v("系统日志")])]),a("div",{staticClass:"header-desc"},[e._v(" 查看系统操作日志记录，支持按时间和类型筛选 ")])]),a("div",{staticClass:"header-content"},[a("div",{staticClass:"left-area"},[a("el-select",{attrs:{placeholder:"请选择日志类型",clearable:""},on:{change:e.handleSearch},model:{value:e.queryParams.type,callback:function(t){e.$set(e.queryParams,"type",t)},expression:"queryParams.type"}},e._l(e.typeOptions,(function(e){return a("el-option",{key:e.type,attrs:{label:e.value,value:e.type}})})),1),a("el-select",{attrs:{placeholder:"请选择执行状态",clearable:""},on:{change:e.handleSearch},model:{value:e.queryParams.isSuccess,callback:function(t){e.$set(e.queryParams,"isSuccess",t)},expression:"queryParams.isSuccess"}},e._l(e.statusOptions,(function(e){return a("el-option",{key:e.isSuccess,attrs:{label:e.value,value:e.isSuccess}})})),1),a("el-date-picker",{attrs:{type:"datetime",placeholder:"开始时间","value-format":"yyyy-MM-dd HH:mm:ss",clearable:""},on:{change:e.handleSearch},model:{value:e.queryParams.startTime,callback:function(t){e.$set(e.queryParams,"startTime",t)},expression:"queryParams.startTime"}}),a("el-date-picker",{attrs:{type:"datetime",placeholder:"结束时间","value-format":"yyyy-MM-dd HH:mm:ss",clearable:""},on:{change:e.handleSearch},model:{value:e.queryParams.endTime,callback:function(t){e.$set(e.queryParams,"endTime",t)},expression:"queryParams.endTime"}})],1),a("div",{staticClass:"right-area"},[a("el-button",{attrs:{type:"success",icon:"el-icon-download"},on:{click:e.handleExport}},[e._v(" 导出日志 ")])],1)])]),a("el-card",{staticClass:"table-card",attrs:{shadow:"hover"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"80",align:"center"}}),a("el-table-column",{attrs:{prop:"type",label:"日志类型",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"操作日志"===t.row.type?"primary":"success"}},[e._v(" "+e._s(t.row.type)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"operateUser",label:"操作用户",width:"120",align:"center"}}),a("el-table-column",{attrs:{prop:"requestMethod",label:"请求方式",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getMethodTagType(t.row.requestMethod),size:"mini"}},[e._v(" "+e._s(t.row.requestMethod)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"requestUri",label:"请求地址","min-width":"200","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"methodName",label:"操作方法",width:"150","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"requestIp",label:"IP地址",width:"150",align:"center"}}),a("el-table-column",{attrs:{prop:"requestTime",label:"耗时(ms)",width:"100",align:"center"}}),a("el-table-column",{attrs:{prop:"isSuccess",label:"状态",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"成功"===t.row.isSuccess?"success":"danger"}},[e._v(" "+e._s(t.row.isSuccess)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"operateTime",label:"操作时间",width:"180",align:"center"}}),a("el-table-column",{attrs:{label:"详情",width:"80",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-view"},on:{click:function(a){return e.handleViewDetail(t.row)}}})]}}])})],1),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":e.pageParams.pageNum,"page-sizes":[5,10,20,50,100],"page-size":e.pageParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("el-dialog",{attrs:{title:"日志详情",visible:e.detailVisible,width:"700px","custom-class":"log-detail-dialog"},on:{"update:visible":function(t){e.detailVisible=t}}},[a("div",{staticClass:"detail-content"},[a("div",{staticClass:"detail-item"},[a("div",{staticClass:"item-label"},[e._v("请求参数")]),a("pre",{staticClass:"item-value code-block"},[e._v(e._s(e.formatJson(e.currentDetail.requestParams)))])]),a("div",{staticClass:"detail-item"},[a("div",{staticClass:"item-label"},[e._v("响应数据")]),a("pre",{staticClass:"item-value code-block"},[e._v(e._s(e.formatJson(e.currentDetail.responseData)))])])])])],1)},l=[],i=(a("e9c4"),a("b64b"),a("d3b7"),a("ac1f"),a("3ca3"),a("466d"),a("ddb0"),a("2b3d"),a("bf19"),a("9861"),a("99af"),a("b775"));function n(e,t,a){return Object(i["a"])({url:"/log/".concat(e,"/").concat(t),method:"get",params:a})}function r(e){return Object(i["a"])({url:"/log/export",method:"get",params:e,responseType:"blob"})}var o={name:"Log",data:function(){return{queryParams:{type:void 0,isSuccess:void 0,startTime:void 0,endTime:void 0},typeOptions:[{type:1,value:"操作日志"},{type:2,value:"登录日志"}],statusOptions:[{isSuccess:1,value:"成功"},{isSuccess:2,value:"失败"}],tableData:[],pageParams:{pageNum:1,pageSize:10},total:0,loading:!1,detailVisible:!1,currentDetail:{}}},created:function(){this.getList()},methods:{formatJson:function(e){try{var t=JSON.parse(e);return JSON.stringify(t,null,2)}catch(a){return e}},getMethodTagType:function(e){var t={GET:"",POST:"success",PUT:"warning",DELETE:"danger"};return t[e]||"info"},getList:function(){var e=this;this.loading=!0,n(this.pageParams.pageNum,this.pageParams.pageSize,this.queryParams).then((function(t){e.tableData=t.data.data,e.total=t.data.total})).finally((function(){e.loading=!1}))},handleViewDetail:function(e){this.currentDetail=e,this.detailVisible=!0},handleSearch:function(){this.pageParams.pageNum=1,this.getList()},handleExport:function(){var e=this;this.$confirm("确认导出日志数据?","提示",{type:"warning"}).then((function(){var t=e.$loading({lock:!0,text:"正在导出数据，请稍候...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});r(e.queryParams).then((function(t){var a=document.createElement("a");a.href=window.URL.createObjectURL(t.data);var s=t.headers["content-disposition"];if(s){var l=s.match(/filename\*=utf-8''(.+)/);l&&(a.download=decodeURIComponent(l[1]))}else a.download="日志.xlsx";document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(a.href),e.getList(),e.$message.success("导出成功")})).finally((function(){t.close()}))})).catch((function(){e.$message.info("已取消导出")}))},handleSizeChange:function(e){this.pageParams.pageSize=e,this.getList()},handleCurrentChange:function(e){this.pageParams.pageNum=e,this.getList()}}},c=o,d=(a("e25f"),a("2877")),u=Object(d["a"])(c,s,l,!1,null,"609a7952",null);t["default"]=u.exports},"57d1":function(e,t,a){},e25f:function(e,t,a){"use strict";a("57d1")}}]);